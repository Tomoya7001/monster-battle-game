# 技システム仕様書 v3.2

**作成日**: 2025-12-16  
**最終更新**: 2025-12-28  
**バージョン**: v3.2（Sランク威力追加、用語統一）  
**ステータス**: Phase1 確定版

---

## 1. 概要

技はモンスターがバトル中に使用するアクティブスキル。コストを消費して発動し、ダメージや特殊効果を与える。

---

## 2. 技の基本構造

### 2.1 データ構造

| フィールド | 型 | 説明 |
|-----------|-----|------|
| skill_id | string | 技ID（一意） |
| name | string | 技名 |
| element | string | 属性（fire/water/thunder/wind/earth/light/dark/none） |
| cost | int | 消費コスト（0-6） |
| power | string | 威力ランク（D/C/B/A/S/SS） |
| damage_type | string | ダメージ種別（physical/magical/adaptive/none） |
| effect | string | 追加効果（1つまで） |

### 2.2 ダメージ種別

| 種別 | 説明 | 使用ステータス |
|------|------|----------------|
| physical | 攻撃技 | 攻撃 |
| magical | 魔力技 | 魔力 |
| adaptive | 適応型 | 攻撃と魔力の高い方 |
| none | ダメージなし | - |

### 2.3 技の分類

| 分類 | 説明 |
|------|------|
| **attack** | ダメージを与える技（追加効果は1つまで） |
| **support** | ダメージなし、回復やバフを行う技 |
| **control** | 状態異常を付与する攻撃技 |
| **ultimate** | 奥義（バトル中パーティで1回のみ） |

### 2.4 技設計ルール

| ルール | 内容 |
|--------|------|
| 攻撃技の追加効果 | **最大1つ** |
| 効果の表現 | わかりやすい日本語（%表記は最小限） |
| 複雑な条件分岐 | **禁止** |

---

## 3. 威力ランクシステム

| ランク | 威力倍率 | コスト目安 | 用途 |
|--------|----------|------------|------|
| D | 0.30 | 1 | 小技、先制技 |
| C | 0.55 | 2 | 通常技 |
| B | 0.80 | 3 | 中威力技 |
| A | 1.10 | 4 | 強技 |
| **S** | **1.50** | **5** | **高コスト通常技（虚空専用）** |
| SS | 2.00 | 5（奥義）/6 | 奥義（Attack型）、女神召喚 |

### 3.1 Sランク威力技「虚空」

| 項目 | 内容 |
|------|------|
| 技名 | 虚空 |
| 属性 | 無 |
| コスト | 5 |
| 威力 | S (1.50) |
| ダメージ種別 | adaptive（攻撃と魔力の高い方で計算） |
| 効果 | なし |
| 特徴 | 攻撃型・魔力型どちらでも活用可能な高火力技 |

**設計意図:**
- 奥義（SS威力）との差別化：奥義は属性付き・1回限り / 虚空は無属性・何度でも使用可
- 攻撃型・魔力型の両方で使えるため、ビルドの柔軟性が向上

---

## 4. ダメージ計算式

### 4.1 基本式

```
ダメージ = 攻撃側ステ × 威力倍率 × 属性相性 × 防御補正 × 乱数 × クリティカル
```

### 4.2 各要素の計算

| 要素 | 計算式 |
|------|--------|
| 攻撃側ステ | 攻撃技→攻撃 / 魔力技→魔力 / adaptive→高い方 |
| 威力倍率 | 威力ランク参照（上記） |
| 属性相性 | 有利×1.8 / 等倍×1.0 / 不利×0.55 |
| 防御補正 | `1 - (防御 / (防御 + 100))` |
| 乱数 | 0.85〜1.00（ランダム） |
| クリティカル | 発生時×1.5（基本6%） |

### 4.3 計算例

```
【例】攻撃100のモンスターが威力B技で防御50の相手を攻撃（等倍）

攻撃側ステ: 100
威力倍率: 0.80（B）
属性相性: 1.0（等倍）
防御補正: 1 - (50 / 150) = 0.667
乱数: 0.93（仮）
クリティカル: 1.0（なし）

ダメージ = 100 × 0.80 × 1.0 × 0.667 × 0.93 × 1.0 ≒ 50
```

---

## 5. コストシステム

### 5.1 基本ルール

| 項目 | 値 |
|------|-----|
| 初期コスト | 4 |
| 最大コスト | 7 |
| 毎ターン回復 | +2 |

### 5.2 コスト別設計基準

| コスト | 威力のみ | +軽い効果 | +強い効果 | 備考 |
|--------|---------|----------|----------|------|
| 0 | × | バフ↑1のみ | × | ノエル専用 |
| 1 | D | バフ↑1、デバフ↓1 | **禁止** | 毎ターン使用可 |
| 2 | C | D+軽効果、バフ↑↑ | × | 毎ターン使用可 |
| 3 | B | C+軽効果、HP30回復 | D+強効果 | 主力技 |
| 4 | A | B+軽効果、HP50回復 | C+強効果 | 強力な技 |
| 5 | S | A+軽効果 | B+強効果 | 奥義/虚空 |
| 6 | SS | S+デメリット | × | 女神召喚（ノエル専用） |

**効果分類:**
- 軽い効果: ステ↓1、先制+1、クリ率UP
- 強い効果: ステ↓2以上、状態異常確定、先制+2、ドレイン25%以上

---

## 6. 優先度システム

| 優先度 | 分類 | 技例 |
|--------|------|------|
| +2 | 強先制技 | 一閃 |
| +1 | 通常先制技 | 先制効果付きの技 |
| 0 | 通常技 | 全ての通常技 |
| -1 | 後攻技 | カウンター、報復 |

### 行動順決定

1. 優先度が高い技を使用した方が先制
2. 同優先度の場合は素早さで判定
3. 同優先度・同素早さの場合はランダム

---

## 7. 奥義システム（v3.0確定版）

### 7.1 基本ルール

- バトル中**パーティ全体で1回**のみ使用可能
- **全奥義コスト5**で統一
- 3タイプに分類

### 7.2 奥義3タイプ

| タイプ | 威力 | 追加効果 | 特徴 |
|--------|------|----------|------|
| **Attack** | SS (2.00) | なし | 純粋な高火力 |
| **Control** | C/B (0.55/0.80) | 状態異常2種確定 | 妨害特化 |
| **Support** | - | HP回復+バフ | 回復・支援特化 |

### 7.3 全39体の奥義一覧

#### Attack型（14体）
| モンスター | 奥義名 | 属性 |
|------------|--------|------|
| ヴェル | 飢餓地獄 | 闇 |
| テュール | 暴君の蹂躙 | 炎 |
| アーサー | 聖剣エクスカリバー | 無 |
| リント | ジェットストリーム | 風 |
| ジャック | 海賊王の覇気 | 水 |
| スコーピオン | 必殺の一撃 | 雷 |
| クロム | 鋼殻砲 | 地 |
| カイト | 秘剣・流星 | 無 |
| カラス | 夜叉旋風 | 風 |
| ラガ | 狂乱の牙 | 地 |
| アスモ | 灼熱の剣舞 | 炎 |
| マモン | 強欲の極み | 地 |
| メルラン | 七色の極光 | 無 |
| タロス | 要塞砲 | 地 |

#### Control型（15体）
| モンスター | 奥義名 | 威力 | 効果 |
|------------|--------|------|------|
| グラム | 完全掌握 | B | 相手コスト-2 |
| タマモ | 狐火・九重 | C | 火傷確定、魅了確定 |
| スライム | 完全吸収 | A | 自分HP50回復、相手バフ全解除 |
| ホノオ | 太陽の怒り | C | 火傷確定、相手攻撃↓↓ |
| リリス | 永遠の悪夢 | C | 悪夢確定、封印確定 |
| キョウカ | 呪符・万霊 | C | 瘴気確定、拘束確定 |
| イム | 小悪魔の本気 | C | 恐怖確定、瘴気確定 |
| カグラ | 神楽の炎 | C | 火傷確定、封印確定 |
| モフ | 胞子爆発 | C | 毒確定、相手速さ↓↓ |
| ファフナ | 雷竜咆哮 | C | 麻痺確定、恐怖確定 |
| ジェイド | 翡翠嵐 | B | 魅了確定 |
| シロネ | 極寒の抱擁 | C | 恐怖確定、拘束確定 |
| ビットマン | 量産型の本気 | B | 麻痺確定 |
| ゼラ | 深淵の終焉 | C | 悪夢確定、瘴気確定 |
| シーラ | 深海の支配 | C | 拘束確定、瘴気確定 |

#### Support型（10体）
| モンスター | 奥義名 | 効果 |
|------------|--------|------|
| ミカ | 天界の裁き | 自分HP80+控えHP30回復、状態異常全解除 |
| ヴルム | 聖竜の息吹 | 自分HP60回復、自分防御↑↑ |
| ラム | 神雷一閃 | 自分HP80+控えHP30回復、麻痺確定 |
| エヴァ | 竜姫の慈愛 | 自分HP60回復、状態異常解除 |
| ルリア | 魂の歌声 | 相手に魅了と麻痺付与+自分HP80回復 |
| レオン | 聖騎士の覚悟 | 味方全員HP30回復+防御↑ |
| ノエル | 聖なる奇跡 | 自分HP80+控えHP30回復、自分防御↑↑ |
| シルフィ | 天翔の祝福 | 自分HP50回復、次T先制権付与+控えと交代する事もできる |
| クリス | 結晶要塞 | 次の攻撃を1回無効、自分HP50回復 |
| セラ | 癒しの聖光 | 自分HP80+控えHP30回復、状態異常解除 |

---

## 8. 状態異常一覧

| 状態異常 | 効果 | 持続 | 計算式 |
|----------|------|------|--------|
| 毒 | 毎ターンダメージ | 3T | 最大HP × 4% |
| 火傷 | 毎ターンダメージ + 攻撃低下 | 3T | 最大HP × 3% + 攻撃 × 0.90 |
| 瘴気 | 毎ターンダメージ + 魔力低下 | 3T | 最大HP × 3% + 魔力 × 0.90 |
| 麻痺 | 速さ低下 | 3T | 速さ × 0.80 |
| 拘束 | 交代不可 | 2T | 交代コマンド無効 |
| 封印 | 最高コスト技使用不可 | 2T | 最大コスト技を選択不可 |
| 魅了 | 被ダメージ増加 | 2T | 被ダメージ × 1.15 |
| 恐怖 | 与ダメージ減少 | 2T | 与ダメージ × 0.85 |
| 悪夢 | 毎ターンダメージ + 回復半減 | 3T | 最大HP × 3% + 回復量 × 0.50 |

---

## 9. バフ・デバフ段階

| 段階 | 倍率 | 表記 |
|------|------|------|
| +3 | ×1.50 | ↑↑↑ |
| +2 | ×1.33 | ↑↑ |
| +1 | ×1.17 | ↑ |
| 0 | ×1.00 | - |
| -1 | ×0.85 | ↓ |
| -2 | ×0.75 | ↓↓ |
| -3 | ×0.67 | ↓↓↓ |

---

## 10. 効果計算式マスター【実装用】

### 10.0 言語ルール（効果表現の統一）

#### HP回復表現（HP150固定基準）
| 表現 | 固定値 | 用途 |
|------|--------|------|
| 少し回復 | 15 | 軽微な回復 |
| 回復 | 30 | 標準的な回復 |
| 多く回復 | 50 | 中程度の回復 |
| 大きく回復 | 80 | 強力な回復 |
| 全回復 | 150 | 完全回復 |

**設計意図:**
- HP150固定（装備で最大200）に対応
- 装備でHPが増えても回復量は一定（バランス維持）
- %表記ではなく固定値で直感的に

#### ダメージ軽減表現
| 表現 | 軽減率 | 用途 |
|------|--------|------|
| 少し軽減 | 15% | 軽微な軽減 |
| 軽減 | 25% | 標準的な軽減 |
| 大幅軽減 | 40% | 強力な軽減 |

#### 用語統一ルール
| 禁止表現 | 正しい表現 |
|----------|------------|
| 物理攻撃 | 攻撃技 |
| 魔法攻撃 | 魔力技 |
| 物理 | 攻撃技 |
| 魔法 | 魔力技 |
| %回復 | 固定値回復 |
| パーティ | 自分と控え全員 |
| 味方全員 | 自分と控え全員 |
| 自身とパーティ | 自分と控え全員 |
| party (target) | all_allies |
| self_and_bench | all_allies |

#### HP消費表現（特殊）
| 表現 | 設定値 | 用途 |
|------|--------|------|
| 体力の半分消費 | cost_half: true | 50%消費用 |

### 10.1 HP回復系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `heal_fixed_15` | HPを少し回復 | HP += 15（固定値） |
| `heal_fixed_30` | HPを回復 | HP += 30（固定値） |
| `heal_fixed_40` | HPを40回復 | HP += 40（固定値） |
| `heal_fixed_50` | HPを多く回復 | HP += 50（固定値） |
| `heal_fixed_60` | HPを60回復 | HP += 60（固定値） |
| `heal_fixed_80` | HPを大きく回復 | HP += 80（固定値） |
| `heal_fixed_150` | HPを全回復 | HP += 150（固定値） |
| `heal_bench_30` | 控えのHPを30回復 | 控えHP += 30（固定値） |

### 10.2 ドレイン（吸収）系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `drain_15` | 与えたダメージで少し回復 | HP += 与ダメージ × 15% |
| `drain_20` | 与えたダメージで回復 | HP += 与ダメージ × 20% |
| `drain_25` | 与えたダメージで回復 | HP += 与ダメージ × 25% |
| `drain_30` | 与えたダメージで多く回復 | HP += 与ダメージ × 30% |
| `drain_50` | 与えたダメージの半分回復 | HP += 与ダメージ × 50% |

### 10.3 ダメージ軽減系

| 効果ID | 表現（ユーザー向け） | 計算式 | 持続 |
|--------|---------------------|--------|------|
| `reduce_15` | 被ダメージを少し軽減 | 被ダメージ × 0.85 | 3T |
| `reduce_25` | 被ダメージを軽減 | 被ダメージ × 0.75 | 3T |
| `reduce_40` | 被ダメージを大幅軽減 | 被ダメージ × 0.60 | 3T |
| `reduce_50_once` | 次の被ダメージを半減 | 被ダメージ × 0.50 | 1回 |
| `reduce_magic` | 魔力技ダメージを軽減 | 魔力技被ダメージ × 0.75 | 3T |
| `nullify_once` | 次の攻撃を1回無効 | 被ダメージ = 0 | 1回 |

### 10.4 反射・反撃系

| 効果ID | 表現（ユーザー向け） | 計算式 | 持続 |
|--------|---------------------|--------|------|
| `reflect_30` | 被弾時に反射ダメージ | 相手HP -= 被ダメージ × 30% | 3T |
| `counter_50` | 後攻時威力が上がる | 威力 × 1.50 | 1回 |

### 10.5 威力変動系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `power_crit_up` | 急所に当たりやすい | クリティカル率 += 12%（+1段階） |
| `power_crit_up2` | 急所に当たりやすい | クリティカル率 += 38%（+2段階） |
| `power_crit_sure` | 急所確定 | クリティカル率 = 100% |
| `power_type_15` | 弱点時威力が上がる | 弱点時: 威力 × 1.5 |
| `power_low_hp_2x` | HP低いと威力2倍 | HP ≤ 30%時: 威力 × 2.0 |
| `power_debuff_bonus` | デバフ数で威力上昇 | 威力 × (1 + デバフ数 × 0.20) |
| `power_buff_bonus` | バフ数で威力上昇 | 威力 × (1 + バフ数 × 0.10) |
| `power_ally_mecha` | 味方メカで威力上昇 | 味方メカ数 × 20%加算 |
| `power_nightmare_2x` | 悪夢状態に威力2倍 | 相手悪夢時: 威力 × 2.0 |
| `power_element_30` | 属性技威力上昇 | 指定属性技: 威力 × 1.30（3T） |
| `power_next_12` | 次の攻撃威力上昇 | 次の攻撃: 威力 × 1.20 |
| `power_next_15` | 次の攻撃威力が上がる | 次の攻撃: 威力 × 1.50 |

### 10.6 防御依存ダメージ

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `def_based_dmg` | 防御力でダメージ | 攻撃力の代わりに防御を使用 |

### 10.7 HP消費系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `cost_hp_15` | HPを少し消費 | HP -= 15（固定値） |
| `cost_hp_30` | HPを消費 | HP -= 30（固定値） |
| `cost_hp_40` | HPを多く消費 | HP -= 40（固定値） |

### 10.8 コスト操作系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `cost_enemy_minus1` | 相手のコストを1減らす | 相手コスト -= 1 |
| `cost_enemy_minus2` | 相手のコストを2減らす | 相手コスト -= 2 |

### 10.9 命中・回避系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `accuracy_sure` | 必中 | 命中率 = 100% |
| `accuracy_down` | 相手の命中を下げる | 相手命中率 × 0.83（-1段階） |
| `evasion_up` | 回避を上げる | 回避率 × 1.17（+1段階） |
| `evasion_up2` | 回避を大きく上げる | 回避率 × 1.33（+2段階） |

### 10.10 優先度（先制）系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `priority_plus1` | 先制 | 優先度 +1 |
| `priority_plus2` | 強先制 | 優先度 +2 |
| `priority_next` | 次ターン先制権確定 | 次ターン優先度 +99 |

### 10.11 連続攻撃系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `multi_hit_2` | 2回攻撃 | ダメージ計算を2回実行 |
| `multi_hit_3` | 3回攻撃 | ダメージ計算を3回実行 |

### 10.12 適応型ダメージ

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `adaptive_damage` | 攻撃と魔力の高い方でダメージ計算 | max(攻撃, 魔力) × 威力倍率 |

### 10.13 特殊系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `copy_buff` | 相手のバフをコピー | 相手のバフ段階を自分に適用 |
| `steal_buff` | 相手のバフを奪う | 相手バフ解除 + 自分に適用 |
| `clear_enemy_buff` | 相手のバフを全て解除 | 相手の全バフ段階を0に |
| `clear_ailment` | 状態異常を解除 | 状態異常フラグをリセット |
| `clear_all_ailment` | 全状態異常を解除 | 全員の状態異常フラグをリセット |
| `copy_skill` | 相手の技をコピー | 相手の最後の技を使用可能に |
| `survice_1hp` | 瀕死時HP1で耐える | HP ≤ 0時: HP = 1（1回のみ） |
| `no_consecutive` | 連続使用不可 | 同じ技を連続で選択不可 |
| `self_action_skip` | 自分行動不能 | 次ターン行動スキップ |
| `dark_effective` | 闇に強い | 闇属性相性 × 2.0 |
| `show_weakness` | 弱点を可視化 | 相手の弱点属性を表示 |

### 10.14 固定ダメージ系

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `fixed_dmg_40` | 40固定ダメージ | 相手HP -= 40（防御無視） |

### 10.15 回復量依存ダメージ

| 効果ID | 表現（ユーザー向け） | 計算式 |
|--------|---------------------|--------|
| `heal_based_dmg` | 回復量で威力上昇 | 威力 × (1 + このバトルでの回復量 / 200)（最大+50%） |

---

## 11. 特殊技

### 11.1 コスト0技
- **女神への祈り**（ノエル専用）: 自分防御↑

### 11.2 コスト5技（Sランク威力）
- **虚空**（共通習得可）: 威力S、攻撃と魔力の高い方でダメージ計算

### 11.3 コスト6技
- **女神召喚**（ノエル専用）: 威力SS、使用後自分魔力↓↓↓

---

## 12. クリティカルシステム

### 12.1 発生率

| 条件 | 発生率 |
|------|--------|
| 通常 | 6% |
| 急所ランク+1 | 12% |
| 急所ランク+2 | 50% |
| 急所ランク+3以上 | 100% |

### 12.2 クリティカル時の効果
- ダメージ × 1.5
- 相手の防御バフを無視

---

## 変更履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|----------|
| **v3.2** | **2025-12-28** | Sランク威力(1.50)追加、「虚空」技新設（adaptive damage）、用語統一（攻撃技/魔力技）、コスト別設計基準更新 |
| v3.1 | 2025-12-25 | 効果計算式マスター追加、ダメージ計算式追加 |
| v3.0 | 2025-12-24 | JSONマスターデータ準拠版 |
| v2.1 | 2025-12-22 | 奥義コスト統一版 |
| v2.0 | 2025-12-20 | バランス改修版 |
| v1.0 | 2025-12-16 | 初版作成 |

---

## 関連ドキュメント

- [技一覧マスターデータ](./skill_list_v10.0.md)
- [バトルシステム仕様書](./battle_system_v8.7.md)
- [技バランス修正パッチ v11.0](./skill_balance_patch_v11.0.md)
